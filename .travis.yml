language: python
jobs:
  include:
    - stage: deploy
      dist: xenial
      python: 3.8
      sudo: required
      deploy:
        provider: pypi
        user: $PYPI_USER
        password: $PYPI_PASSWORD
        skip_cleanup: true
        distributions: "twine upload dist/*"
        on:
          branch: master
          repo: tolstislon/testrail-api

install:
  - pip install m2r==0.2.1
  - pip install twine==3.1.1

script:
  - python setup.py bdist_wheel

branches:
  only:
    - master